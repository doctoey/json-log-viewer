<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏•‡∏á JSON Log ‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢</title>
    <style>
      body {
        font-family: "Sarabun", -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, sans-serif;
        background-color: #f4f6f8;
        padding: 20px;
        max-width: 800px;
        margin: 0 auto;
      }
      h1 {
        color: #333;
        text-align: center;
      }
      .container {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      label {
        font-weight: bold;
        display: block;
        margin-bottom: 8px;
      }
      textarea {
        width: 100%;
        height: 150px;
        border: 1px solid #ccc;
        border-radius: 4px;
        padding: 10px;
        font-family: monospace;
        box-sizing: border-box; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ç‡∏≠‡∏ö */
      }
      button {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        font-size: 16px;
        border-radius: 4px;
        cursor: pointer;
        margin-top: 10px;
        width: 100%;
      }
      button:hover {
        background-color: #0056b3;
      }

      .result-box {
        margin-top: 20px;
        background-color: #282c34;
        color: #abb2bf;
        padding: 15px;
        border-radius: 4px;
        overflow-x: auto;
        display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô */
      }
      pre {
        margin: 0;
        font-family: "Consolas", monospace;
        font-size: 14px;
      }

      /* ‡∏™‡∏µ Syntax Highlight ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢‡πÜ */
      .key {
        color: #e06c75;
      }
      .string {
        color: #98c379;
      }
      .number {
        color: #d19a66;
      }
      .boolean {
        color: #56b6c2;
      }
      .null {
        color: #c678dd;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üõ†Ô∏è ‡πÅ‡∏õ‡∏•‡∏á Log ‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢</h1>

      <label for="inputData">‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (String) ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà:</label>
      <textarea
        id="inputData"
        placeholder='‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: "{\"log\":{\"event\":...}}"'
      ></textarea>

      <button onclick="convertJson()">‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>

      <div id="resultContainer" class="result-box">
        <pre id="output"></pre>
      </div>
    </div>

    <script>
      function convertJson() {
        const input = document.getElementById("inputData").value.trim();
        const outputDiv = document.getElementById("output");
        const resultBox = document.getElementById("resultContainer");

        if (!input) {
          alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
          return;
        }

        try {
          let parsedData;

          // 1. ‡∏•‡∏≠‡∏á Parse ‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å (‡πÄ‡∏ú‡∏∑‡πà‡∏≠ user ‡∏Å‡πä‡∏≠‡∏õ‡∏°‡∏≤‡πÅ‡∏ö‡∏ö object ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)
          try {
            parsedData = JSON.parse(input);
          } catch (e) {
            // ‡∏ñ‡πâ‡∏≤ Parse ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô String ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ quote ‡∏Ñ‡∏£‡∏≠‡∏ö ‡∏´‡∏£‡∏∑‡∏≠ Format ‡∏ú‡∏¥‡∏î
            // ‡∏•‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÄ‡∏Ñ‡∏™‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô (‡πÄ‡∏ä‡πà‡∏ô user ‡∏•‡∏∑‡∏°‡πÉ‡∏™‡πà quote ‡∏Ñ‡∏£‡∏≠‡∏ö string)
            parsedData = input;
          }

          // 2. ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏ñ‡πâ‡∏≤ Parse ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô String (‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô JSON ‡∏ã‡πâ‡∏≠‡∏ô String ‡πÅ‡∏ö‡∏ö‡πÉ‡∏ô‡πÇ‡∏à‡∏ó‡∏¢‡πå)
          // ‡πÉ‡∏´‡πâ Parse ‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö
          if (typeof parsedData === "string") {
            // ‡∏•‡∏ö quote ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ‡πÅ‡∏•‡πâ‡∏ß unescape
            try {
              parsedData = JSON.parse(parsedData);
            } catch (e) {
              // ‡∏ñ‡πâ‡∏≤ parse ‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô string ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠ format ‡∏ú‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á‡πÜ
              throw new Error("Format ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
            }
          }

          // 3. ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ö‡∏ö‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° (Syntax Highlight)
          const prettyHtml = syntaxHighlight(parsedData);
          outputDiv.innerHTML = prettyHtml;
          resultBox.style.display = "block";
        } catch (error) {
          alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á\n" + error.message);
          console.error(error);
        }
      }

      // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏≥‡∏™‡∏µ‡∏™‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢
      function syntaxHighlight(json) {
        if (typeof json != "string") {
          json = JSON.stringify(json, undefined, 2);
        }
        json = json
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;");
        return json.replace(
          /("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,
          function (match) {
            var cls = "number";
            if (/^"/.test(match)) {
              if (/:$/.test(match)) {
                cls = "key";
              } else {
                cls = "string";
              }
            } else if (/true|false/.test(match)) {
              cls = "boolean";
            } else if (/null/.test(match)) {
              cls = "null";
            }
            return '<span class="' + cls + '">' + match + "</span>";
          }
        );
      }
    </script>
  </body>
</html>
